{"ast":null,"code":"var _jsxFileName = \"/Users/lolo/Desktop/Bootcamp/bootcamp/Proyecto 3/crossfit/client/src/components/Profile/ProfilePhoto.js\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport './Profile.css';\nimport { Link, useNavigate } from 'react-router-dom';\nimport NavBar from '../NavBar/NavBar';\nimport swal from 'sweetalert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProfilePhoto = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const token = localStorage.getItem(\"firsLogin\");\n  const [imagen, setImagen] = useState(null); // const [userData, setUserData] = useState([]) \n\n  const [publicId, setPublicId] = useState(null);\n  const [successMessage, setSuccessMessage] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n  useEffect(() => {\n    if (!token) navigate('/');\n    axios.get(\"http://localhost:5000/api/profile\", {\n      headers: {\n        \"Authorization\": token\n      }\n    }).then(response => {\n      // setUserData(response.data.user)\n      setImagen(response.data.user.imagen.url);\n      setPublicId(response.data.user.imagen.public_id); // setImagess(response.data.user.imagen.public_id)\n    });\n  }); // ------------------------------- Función de eliminar imagen ------------------------------\n\n  const showAlert = () => {\n    swal({\n      text: \"¿Estás seguro que quieres eliminar la foto?\",\n      icon: \"warning\",\n      buttons: [\"No\", \"Si\"]\n    }).then(async respuesta => {\n      if (respuesta) {\n        try {\n          const response = await axios.post(\"http://localhost:5000/api/destroyPhoto\", {\n            \"public_id\": publicId\n          }, {\n            headers: {\n              \"Authorization\": token\n            }\n          });\n          await axios.put(\"http://localhost:5000/api/updateProfile\", {\n            \"imagen\": {\n              \"public_id\": \"\",\n              \"url\": \"https://res.cloudinary.com/dzenpc7wi/image/upload/v1642780148/crossfitAPP/auxt7ab5smg7879zbq4f.webp\"\n            }\n          }, {\n            headers: {\n              \"Authorization\": token\n            }\n          });\n          setSuccessMessage(response.data.msg);\n          swal({\n            text: \"La foto se ha eliminado correctamente\",\n            icon: \"success\",\n            timer: \"2000\"\n          }); // console.log(response)\n        } catch (err) {\n          setErrorMessage(err.response.data.msg);\n        }\n      }\n    });\n  }; // ------------------------------- Función para cargar imagen de perfil --------------------\n\n\n  const handleUpload = async e => {\n    try {\n      const file = e.target.files[0];\n      if (!file) return alert(\"No se ha subido ningún archivo\");\n      if (file.size > 1024 * 1024 * 2) return alert(\"Archivo demasiado grande\");\n      if (file.type !== \"image/jpeg\" && file.type !== \"image/png\") return alert(\"Formato de archivo no soportado\");\n      let formData = new FormData();\n      formData.append(\"file\", file); //   setLoading(true);\n\n      const res = await axios.post(`http://localhost:5000/api/upload`, formData, {\n        headers: {\n          \"content-type\": \"multipart/form-data\",\n          \"Authorization\": token\n        }\n      }); // Para añadir la imagen al usuario\n\n      const responsePhoto = await axios.put(\"http://localhost:5000/api/updateProfile\", {\n        \"imagen\": {\n          \"public_id\": res.data.public_id,\n          \"url\": res.data.url\n        }\n      }, {\n        headers: {\n          \"Authorization\": token\n        }\n      }); // console.log(responsePhoto.data.message)\n\n      setSuccessMessage(responsePhoto.data.msg); //   //   console.log(res.data.post);\n    } catch (err) {\n      alert(err.message);\n      setErrorMessage(err.responsePhoto.data.msg);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(NavBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"subtitle\",\n        children: \"Perfil - Cambiar Foto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container_photo\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          className: \"profile_photo\",\n          alt: \"\",\n          src: imagen\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container_buttons\",\n        children: /*#__PURE__*/_jsxDEV(\"label\", {\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"upload_imagen\",\n            type: \"file\",\n            name: \"file\",\n            onChange: handleUpload\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message_login\",\n        style: {\n          display: successMessage ? \"block\" : \"none\"\n        },\n        children: successMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"message_login\",\n        style: {\n          display: errorMessage ? \"block\" : \"none\"\n        },\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button_delete_photo\",\n        onClick: showAlert,\n        children: \"Eliminar foto\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      to: \"/profile\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container_back_button\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"far fa-arrow-alt-circle-left buttonBack\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProfilePhoto, \"HzPO6eu2ovXnb7rdi8eSmmFuRKk=\", false, function () {\n  return [useNavigate];\n});\n\n_c = ProfilePhoto;\nexport default ProfilePhoto;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfilePhoto\");","map":{"version":3,"sources":["/Users/lolo/Desktop/Bootcamp/bootcamp/Proyecto 3/crossfit/client/src/components/Profile/ProfilePhoto.js"],"names":["axios","useEffect","useState","Link","useNavigate","NavBar","swal","ProfilePhoto","navigate","token","localStorage","getItem","imagen","setImagen","publicId","setPublicId","successMessage","setSuccessMessage","errorMessage","setErrorMessage","get","headers","then","response","data","user","url","public_id","showAlert","text","icon","buttons","respuesta","post","put","msg","timer","err","handleUpload","e","file","target","files","alert","size","type","formData","FormData","append","res","responsePhoto","message","display"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport { useEffect, useState } from 'react'\nimport './Profile.css'\nimport { Link, useNavigate } from 'react-router-dom'\nimport NavBar from '../NavBar/NavBar'\nimport swal from 'sweetalert'\n\n\nconst ProfilePhoto = () =>{\n\n    \n    const navigate = useNavigate()\n    const token = localStorage.getItem(\"firsLogin\")\n    const [imagen, setImagen] = useState(null)\n    // const [userData, setUserData] = useState([]) \n    const [publicId, setPublicId] = useState(null)\n\n    const [successMessage, setSuccessMessage] = useState(null)\n    const [errorMessage, setErrorMessage] = useState(null)\n\n    useEffect(()=>{\n      if (!token) navigate('/')\n        axios.get(\"http://localhost:5000/api/profile\", {headers:{\"Authorization\": token}}).then((response) =>{\n            // setUserData(response.data.user)\n            setImagen(response.data.user.imagen.url)\n            setPublicId(response.data.user.imagen.public_id)\n            // setImagess(response.data.user.imagen.public_id)\n        })\n    }, )\n    \n    // ------------------------------- Función de eliminar imagen ------------------------------\n    \n    const showAlert =  () =>{\n      \n      swal({\n          text: \"¿Estás seguro que quieres eliminar la foto?\",\n          icon: \"warning\",\n          buttons: [\"No\", \"Si\"]\n      }).then(async (respuesta)  =>{\n          \n          if(respuesta){\n            try {\n              const response = await axios.post(\"http://localhost:5000/api/destroyPhoto\", {\"public_id\": publicId}, {headers:{\"Authorization\": token}})\n  \n              await axios.put(\"http://localhost:5000/api/updateProfile\", {\n                \"imagen\" : {\n                      \"public_id\": \"\",\n                      \"url\": \"https://res.cloudinary.com/dzenpc7wi/image/upload/v1642780148/crossfitAPP/auxt7ab5smg7879zbq4f.webp\"\n                }\n            }, {headers:{\"Authorization\": token}} )\n  \n              setSuccessMessage(response.data.msg)\n              swal({text: \"La foto se ha eliminado correctamente\", icon: \"success\", timer: \"2000\"})\n              // console.log(response)\n          } catch (err) {\n              setErrorMessage(err.response.data.msg)\n          }\n                 \n          }\n          })\n  }\n\n    // ------------------------------- Función para cargar imagen de perfil --------------------\n\n    \n\n    const handleUpload = async (e) => {\n        \n        \n        try {\n           \n          const file = e.target.files[0];\n    \n          if (!file) return alert(\"No se ha subido ningún archivo\");\n          if (file.size > 1024 * 1024 * 2) return alert(\"Archivo demasiado grande\");\n          if (file.type !== \"image/jpeg\" && file.type !== \"image/png\") return alert(\"Formato de archivo no soportado\");\n    \n          let formData = new FormData();\n          formData.append(\"file\", file);\n    \n        //   setLoading(true);\n          const res = await axios.post(`http://localhost:5000/api/upload`, formData, \n            {\n              headers: {\n                \"content-type\": \"multipart/form-data\",\n                \"Authorization\": token,\n              },\n            }\n          )\n         \n          // Para añadir la imagen al usuario\n\n          const responsePhoto = await axios.put(\"http://localhost:5000/api/updateProfile\", {\n              \"imagen\" : {\n                    \"public_id\": res.data.public_id,\n                    \"url\": res.data.url\n              }\n          }, {headers:{\"Authorization\": token}} )\n\n          // console.log(responsePhoto.data.message)\n\n          setSuccessMessage(responsePhoto.data.msg)\n        //   //   console.log(res.data.post);\n        } catch (err) {\n          alert(err.message);\n          setErrorMessage(err.responsePhoto.data.msg)\n        }\n        \n      }\n\n\n    return(\n        <div>\n          <NavBar />\n            <div className=\"container\">\n                <h2 className=\"subtitle\">Perfil - Cambiar Foto</h2>\n                <div className=\"container_photo\">\n                    <img className=\"profile_photo\" alt=\"\" src={imagen}></img>\n                </div>\n                <div className=\"container_buttons\">\n                <label>\n                <input className=\"upload_imagen\" type=\"file\" name=\"file\" onChange={handleUpload}></input></label>\n                </div>\n                <div className=\"message_login\" style={{display: successMessage ? \"block\": \"none\"}}>{successMessage}</div>\n                <div className=\"message_login\" style={{display: errorMessage ? \"block\": \"none\"}}>{errorMessage}</div>\n                <button className=\"button_delete_photo\"  onClick={showAlert}>Eliminar foto</button>\n            </div>\n\n            <Link to=\"/profile\">\n                <div className=\"container_back_button\">\n                <i className=\"far fa-arrow-alt-circle-left buttonBack\"></i>\n                </div>\n            </Link>\n        </div>\n    )\n}\n\nexport default ProfilePhoto"]},"metadata":{},"sourceType":"module"}